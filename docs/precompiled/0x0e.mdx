---
fork: Prague
---

## Notes

BLS12-381 G2 multi-scalar multiplication (MSM) precompile performs efficient computation of multiple scalar multiplications followed by addition on the G2 group. This operation computes: `k1 * P1 + k2 * P2 + ... + kn * Pn` where `ki` are scalars and `Pi` are G2 points.

G2 points are defined over the quadratic extension field Fp2, making this operation more expensive than the corresponding G1 MSM. The operation includes subgroup checks for all input points. More information can be found in [EIP-2537](https://eips.ethereum.org/EIPS/eip-2537).

## Inputs

The input consists of pairs of G2 points and scalars. Input length must be a multiple of 288 bytes (256 bytes for G2 point + 32 bytes for scalar).

For each 288-byte pair:

| Byte range | Name | Description |
|-----------:|-----:|------------:|
| `[0; 63]` (64 bytes) | x_c0 | X coordinate c0 component of G2 point |
| `[64; 127]` (64 bytes) | x_c1 | X coordinate c1 component of G2 point |
| `[128; 191]` (64 bytes) | y_c0 | Y coordinate c0 component of G2 point |
| `[192; 255]` (64 bytes) | y_c1 | Y coordinate c1 component of G2 point |
| `[256; 287]` (32 bytes) | scalar | Scalar multiplier (big-endian) |

G2 points are encoded as elements of Fp2. Input points must be valid G2 curve points and in the correct subgroup. Scalars must be less than the BLS12-381 subgroup order.

## Output

| Byte range | Name | Description |
|-----------:|-----:|------------:|
| `[0; 63]` (64 bytes) | x_c0 | X coordinate c0 component of result point on BLS12-381 G2 |
| `[64; 127]` (64 bytes) | x_c1 | X coordinate c1 component of result point on BLS12-381 G2 |
| `[128; 191]` (64 bytes) | y_c0 | Y coordinate c0 component of result point on BLS12-381 G2 |
| `[192; 255]` (64 bytes) | y_c1 | Y coordinate c1 component of result point on BLS12-381 G2 |

Returns the result of the G2 multi-scalar multiplication. Dynamic gas cost with volume discounts starting at **55,000 gas**. If the input is not valid, all gas provided is consumed and there is no return data, indicating a precompile contract error.

## Example

| Input | Output |
|------:|-------:|
| `0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb80000000000000000000000000000000013e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000103121a2ceaae586d240843a398967325f8eb5a93e8fea99b62b9f88d8556c80dd726a4b30e84a36eeabaf3592937f2700000000000000000000000000000000086b990f3da2aeac0a36143b7d7c824428215140db1bb859338764cb58458f081d92664f9053b50b3fbd2e4723121b68000000000000000000000000000000000f9e7ba9a86a8f7624aa2b42dcc8772e1af4ae115685e60abc2c9b90242167acef3d0be4050bf935eed7c3b6fc7ba77e000000000000000000000000000000000d22c3652d0dc6f0fc9316e14268477c2049ef772e852108d269d9c38dba1d4802e8dae479818184c08f9a569d8784510000000000000000000000000000000000000000000000000000000000000002` | `0x00000000000000000000000000000000009cc9ed6635623ba19b340cbc1b0eb05c3a58770623986bb7e041645175b0a38d663d929afb9a949f7524656043bccc000000000000000000000000000000000c0fb19d3f083fd5641d22a861a11979da258003f888c59c33005cb4a2df4df9e5a2868832063ac289dfa3e997f21f8a00000000000000000000000000000000168bf7d87cef37cf1707849e0a6708cb856846f5392d205ae7418dd94d94ef6c8aa5b424af2e99d957567654b9dae1d90000000000000000000000000000000017e0fa3c3b2665d52c26c7d4cea9f35443f4f9007840384163d3aa3c7d4d18b21b65ff4380cf3f3b48e94b5eecb221dd` |